(window.webpackJsonp=window.webpackJsonp||[]).push([[384],{879:function(s,r,a){"use strict";a.r(r);var t=a(30),_=Object(t.a)({},(function(){var s=this,r=s.$createElement,a=s._self._c||r;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"scrapy-redis实现分布式爬虫"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scrapy-redis实现分布式爬虫"}},[s._v("#")]),s._v(" scrapy_redis实现分布式爬虫")]),s._v(" "),a("h5",{attrs:{id:"学习目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学习目标"}},[s._v("#")]),s._v(" 学习目标")]),s._v(" "),a("ol",[a("li",[s._v("能够应用 scrapy_redis实现分布式爬虫")]),s._v(" "),a("li",[s._v("能够应用 scrapy_redis中RedisCrawlspider类实现分布式爬虫")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_1-redisspider"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-redisspider"}},[s._v("#")]),s._v(" 1 RedisSpider")]),s._v(" "),a("h5",{attrs:{id:"_1-1-分析demo中代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-分析demo中代码"}},[s._v("#")]),s._v(" 1.1 分析demo中代码")]),s._v(" "),a("p",[s._v("通过观察代码：")]),s._v(" "),a("ul",[a("li",[s._v("继承自父类为RedisSpider")]),s._v(" "),a("li",[s._v("增加了一个redis_key的键，没有start_urls，因为分布式中，如果每台电脑都请求一次start_url就会重复")]),s._v(" "),a("li",[s._v("多了"),a("code",[s._v("__init__")]),s._v("方法，该方法不是必须的，可以手动指定allow_domains")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/redis_spider_2.png",alt:""}})]),s._v(" "),a("h5",{attrs:{id:"_1-2-动手实现当当图书爬虫"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-动手实现当当图书爬虫"}},[s._v("#")]),s._v(" 1.2 动手实现当当图书爬虫")]),s._v(" "),a("p",[s._v("需求：抓取当当图书的信息")]),s._v(" "),a("p",[s._v("目标：抓取当当图书又有图书的名字、封面图片地址、图书url地址、作者、出版社、出版时间、价格、图书所属大分类、图书所属小的分类、分类的url地址")]),s._v(" "),a("p",[s._v("url："),a("a",{attrs:{href:"http://book.dangdang.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://book.dangdang.com"),a("OutboundLink")],1)]),s._v(" "),a("h5",{attrs:{id:"思路分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思路分析"}},[s._v("#")]),s._v(" 思路分析：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("程序的入口")]),s._v(" "),a("p",[s._v("当当图书中，从大分类入手，还有一个中间分类，以及小分类，小分类对一个的地址就是列表页的地址")]),s._v(" "),a("p",[s._v("注意，url地址的响应和elements略微不同，其中不是每个大分类都在a标签中，中间部分分类不在span标签中")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E5%BD%93%E5%BD%93%E5%9B%BE%E4%B9%A6%E5%85%A5%E5%8F%A3.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("确定列表页的url地址和程序终止条件")]),s._v(" "),a("p",[s._v("存在下一页")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E5%BD%93%E5%BD%93%E5%AD%98%E5%9C%A8%E4%B8%8B%E4%B8%80%E9%A1%B5.png",alt:""}})]),s._v(" "),a("p",[s._v("不存在下一页")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E5%BD%93%E5%BD%93%E4%B8%8D%E5%AD%98%E5%9C%A8%E4%B8%8B%E4%B8%80%E9%A1%B5.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("确定数据的位置")]),s._v(" "),a("p",[s._v("数据都在url地址对应的响应中，包括列表 "),a("img",{attrs:{src:"/assets/images/%E5%BD%93%E5%BD%93%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BD%8D%E7%BD%AE.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("完善spider")]),s._v(" "),a("p",[s._v("可以使用scrapy的方式创建爬虫，只需要把父类进行修改，添加redis_key")]),s._v(" "),a("p",[s._v("同时在settings.py中进行配置")])])]),s._v(" "),a("h3",{attrs:{id:"_2-rediscrawlspider"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-rediscrawlspider"}},[s._v("#")]),s._v(" 2. RedisCrawlSpider")]),s._v(" "),a("h5",{attrs:{id:"_2-1-分析demo中的代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-分析demo中的代码"}},[s._v("#")]),s._v(" 2.1 分析demo中的代码")]),s._v(" "),a("p",[s._v("和scrapy中的crawlspider的区别在于，继承自的父类不相同，redis_key需要添加")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/RedisCrawlSpider.png",alt:""}})]),s._v(" "),a("h5",{attrs:{id:"_2-2-动手完成亚马逊图书爬虫"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-动手完成亚马逊图书爬虫"}},[s._v("#")]),s._v(" 2.2 动手完成亚马逊图书爬虫")]),s._v(" "),a("p",[s._v("需求：抓取亚马逊图书的信息")]),s._v(" "),a("p",[s._v("目标：抓取亚马逊图书又有图书的名字、封面图片地址、图书url地址、作者、出版社、出版时间、价格、图书所属大分类、图书所属小的分类、分类的url地址")]),s._v(" "),a("p",[s._v("url："),a("a",{attrs:{href:"https://www.amazon.cn/%E5%9B%BE%E4%B9%A6/b/ref=sd_allcat_books_l1?ie=UTF8&node=658390051",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.amazon.cn/%E5%9B%BE%E4%B9%A6/b/ref=sd_allcat_books_l1?ie=UTF8&node=658390051"),a("OutboundLink")],1)]),s._v(" "),a("h5",{attrs:{id:"思路分析-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思路分析-2"}},[s._v("#")]),s._v(" 思路分析：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("确定rule中的规则")]),s._v(" "),a("p",[s._v("可以通过连接提取器中的restrict_xpath来实现url地址的，不需要定位到具体的url地址字符串，定位到准确的标签位置即可")]),s._v(" "),a("p",[s._v("注意：定位到的标签中不能包含不相关的url，否则请求不相关的地址后，数据提取会报错")]),s._v(" "),a("p",[s._v("通过分析大分类和小分类的url地址，发现他们的规则仙童，即一个Rule可以实现从大分类到小分类的到列表页的过程")]),s._v(" "),a("ol",[a("li",[s._v("大分类url地址")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%A4%A7%E5%88%86%E7%B1%BB%E7%9A%84url%E5%9C%B0%E5%9D%80.png",alt:""}})]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("小分类url地址")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%B0%8F%E5%88%86%E7%B1%BB%E7%9A%84url%E5%9C%B0%E5%9D%80.png",alt:""}})]),s._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[s._v("列表页翻页的url地址位置")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%88%97%E8%A1%A8%E9%A1%B5%E7%9A%84url%E5%9C%B0%E5%9D%80.png",alt:""}})]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[s._v("进入详情页翻页的url地址位置")])]),s._v(" "),a("p",[s._v("详情页在h2标签的上一级，定位到h2后，通过"),a("code",[s._v("..")]),s._v("即可实现获取该url")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E4%BA%9A%E9%A9%AC%E9%80%8A%E8%AF%A6%E6%83%85%E9%A1%B5%E7%9A%84url%E5%9C%B0%E5%9D%80.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("详情页数据的抓取")]),s._v(" "),a("p",[s._v("在详情页中，数据有两种，一种是电子书的信息，一种是纸质书的信息，两种页面，数据位置不同")]),s._v(" "),a("ol",[a("li",[s._v("确定书的分类，是电纸书还是纸质书")])]),s._v(" "),a("p",[s._v("电子书")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%B8%BA%E7%94%B5%E5%AD%90%E4%B9%A6.png",alt:""}})]),s._v(" "),a("p",[s._v("纸质书 "),a("img",{attrs:{src:"/assets/images/%E7%A1%AE%E5%AE%9A%E6%98%AF%E5%90%A6%E4%B8%BA%E7%94%B5%E5%AD%90%E4%B9%A62.png",alt:""}})]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("不同类型的书籍分别写xpath，比如价格的提取")])])]),s._v(" "),a("li",[a("p",[s._v("在settings中进行配置")])])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("ol",[a("li",[s._v("scrapy_redis中RedisSPider实现分布式爬虫的方法")]),s._v(" "),a("li",[s._v("demo中RedisCrawlspider类实现分布式爬虫的方法")]),s._v(" "),a("li",[s._v("完成当当图书案例")]),s._v(" "),a("li",[s._v("完成苏宁易购图书案例")])])])}),[],!1,null,null,null);r.default=_.exports}}]);
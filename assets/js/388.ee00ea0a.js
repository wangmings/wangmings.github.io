(window.webpackJsonp=window.webpackJsonp||[]).push([[388],{883:function(s,t,a){"use strict";a.r(t);var r=a(30),e=Object(r.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"crontab定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#crontab定时任务"}},[s._v("#")]),s._v(" crontab定时任务")]),s._v(" "),a("h5",{attrs:{id:"学习目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学习目标"}},[s._v("#")]),s._v(" 学习目标：")]),s._v(" "),a("p",[s._v("了解 crontab定时任务")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_1-crontab的安装和介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-crontab的安装和介绍"}},[s._v("#")]),s._v(" 1. crontab的安装和介绍")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/crontab.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_2-crontab在爬虫中的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-crontab在爬虫中的使用"}},[s._v("#")]),s._v(" 2. crontab在爬虫中的使用")]),s._v(" "),a("h4",{attrs:{id:"_2-1-使用流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-使用流程"}},[s._v("#")]),s._v(" 2.1 使用流程")]),s._v(" "),a("ol",[a("li",[s._v("把爬虫启动命令写入sh文件")]),s._v(" "),a("li",[s._v("给sh脚本添加可执行权限")]),s._v(" "),a("li",[s._v("编辑crontab的配置文件")])]),s._v(" "),a("h4",{attrs:{id:"_2-2-myspier-sh例子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-myspier-sh例子"}},[s._v("#")]),s._v(" 2.2 myspier.sh例子")]),s._v(" "),a("p",[a("strong",[s._v("先把要执行的命令写入脚本")])]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("cd `dirname $"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("` "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" exit "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\npython "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("其中>>表示重定向，把print等信息导入log中")]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("cd `dirname $"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("` "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" exit "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("固定写法，表示先进入当前目录，如果失败则退出该sh脚本 "),a("code",[s._v("2>&1")]),s._v("表示把标准错误作为标准输出，输入用0表示，标准输出用1表示，标准错误用2标识，通过该命令能够把错误一起输出到log中")]),s._v(" "),a("p",[a("strong",[s._v("添加可执行权限")])]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("sudo chmod "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("x myspder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("写入crontab中")])]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("crontab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("进入编辑页面并添加:")])]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ubuntu"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("myspider"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ubuntu"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("run2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("sh脚本文件也可能会报错，对应的可以把其输出和错误重定向到run2.log中")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("p",[s._v("了解crontab的使用")])])}),[],!1,null,null,null);t.default=e.exports}}]);
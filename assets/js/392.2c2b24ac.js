(window.webpackJsonp=window.webpackJsonp||[]).push([[392],{887:function(s,t,a){"use strict";a.r(t);var r=a(30),e=Object(r.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"代码实现分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码实现分析"}},[s._v("#")]),s._v(" 代码实现分析")]),s._v(" "),a("h5",{attrs:{id:"目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目标"}},[s._v("#")]),s._v(" 目标")]),s._v(" "),a("ol",[a("li",[s._v("掌握模块之间的关系")]),s._v(" "),a("li",[s._v("实现自己\b\b框架的\b代码结构")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_1-明确模块之间的逻辑关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-明确模块之间的逻辑关系"}},[s._v("#")]),s._v(" 1 明确模块之间的逻辑关系")]),s._v(" "),a("p",[s._v("五个核心模块和三个内置的对象是关键模块，需要优先实现")]),s._v(" "),a("p",[s._v("先抛开中间件，分析下它们之间的逻辑关系是：")]),s._v(" "),a("ol",[a("li",[s._v("构造spider中start_urls中的请求")]),s._v(" "),a("li",[s._v("传递给调取器进行保存，之后从中取出")]),s._v(" "),a("li",[s._v("取出的request对象交给下载的进行下载\b，返回response")]),s._v(" "),a("li",[s._v("response交给爬虫模块进行解析，\b提取结果")]),s._v(" "),a("li",[s._v("如果结果是request对象，重新交给调度器，如果结果是item对象，交给管道处理")])]),s._v(" "),a("p",[s._v("以上的逻辑是在引擎中完成的")]),s._v(" "),a("p",[s._v("对应的他们在引擎中的逻辑如下图：")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E6%A1%86%E6%9E%B6%E4%BA%94%E5%A4%A7%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E9%80%BB%E8%BE%91%E5%85%B3%E7%B3%BB%E6%B5%81%E7%A8%8B%E5%9B%BE.png",alt:"框架五大核心组件逻辑关系流程图"}})]),s._v(" "),a("h3",{attrs:{id:"_2-设计代码结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-设计代码结构"}},[s._v("#")]),s._v(" 2 设计代码结构")]),s._v(" "),a("ol",[a("li",[s._v("首先给框架起一个名称，如：")])]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v(" scrapy_plus \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[s._v("继续分类以及解耦的设计思想：")]),s._v(" "),a("ul",[a("li",[s._v("把核心模块放置在一起")]),s._v(" "),a("li",[s._v("请求对象模块和响应对象模块统一作为http模块")]),s._v(" "),a("li",[s._v("数据对象单独作为一个分类")])]),s._v(" "),a("p",[s._v("代码结构如下：")])])]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" scrapy_plus\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" __init__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" core\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" __init__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" spider"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" scheduler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" downloader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" pipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" http\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" __init__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("到这里，我们完成了框架的大致结构是设计，那么接下来我们就需要实现模块中的具体内容了")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("ol",[a("li",[s._v("掌握模块\b之间的逻辑关系")])])])}),[],!1,null,null,null);t.default=e.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[361],{856:function(s,t,a){"use strict";a.r(t);var n=a(30),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"常见的反爬手段和解决思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见的反爬手段和解决思路"}},[s._v("#")]),s._v(" 常见的反爬手段和解决思路")]),s._v(" "),a("h5",{attrs:{id:"学习目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学习目标"}},[s._v("#")]),s._v(" 学习目标")]),s._v(" "),a("ol",[a("li",[s._v("了解 通过headers反爬以及对应的解决方法")]),s._v(" "),a("li",[s._v("了解 通过js反爬以及对应的解决方法")]),s._v(" "),a("li",[s._v("了解 通过验证码反爬以及对应的解决方法")]),s._v(" "),a("li",[s._v("了解 通过IP反爬以及对应的解决方法")]),s._v(" "),a("li",[s._v("了解 通过用户行为反爬以及对应的解决方法")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"_1-明确反反爬的主要思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-明确反反爬的主要思路"}},[s._v("#")]),s._v(" 1 明确反反爬的主要思路")]),s._v(" "),a("p",[s._v("反反爬的主要思路就是："),a("strong",[s._v("尽可能的去模拟浏览器，浏览器在如何操作，代码中就如何去实现")]),s._v("。")]),s._v(" "),a("blockquote",[a("p",[s._v("例如：浏览器先请求了地址url1，保留了cookie在本地，之后请求地址url2，带上了之前的cookie，代码中也可以这样去实现。")])]),s._v(" "),a("h3",{attrs:{id:"_2-通过headers字段来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-通过headers字段来反爬"}},[s._v("#")]),s._v(" 2 通过headers字段来反爬")]),s._v(" "),a("blockquote",[a("p",[s._v("headers中有很多字段，这些字段都有可能会被对方服务器拿过来进行判断是否为爬虫")])]),s._v(" "),a("h5",{attrs:{id:"_2-1-通过headers中的user-agent字段来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-通过headers中的user-agent字段来反爬"}},[s._v("#")]),s._v(" 2.1 通过headers中的User-Agent字段来反爬")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：爬虫默认情况下没有User-Agent")]),s._v(" "),a("li",[s._v("解决方法：请求之前添加User-Agent即可；更好的方式是使用User-Agent池来解决（收集一堆User-Agent的方式，或者是随机生成User-Agent）")])]),s._v(" "),a("div",{staticClass:"language-Python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" random\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_ua")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    first_num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("55")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("62")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    third_num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    fourth_num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("140")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    os_type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(Windows NT 6.1; WOW64)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(Windows NT 10.0; WOW64)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(X11; Linux x86_64)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(Macintosh; Intel Mac OS X 10_12_6)'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    chrome_version "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Chrome/{}.0.{}.{}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("first_num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" third_num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fourth_num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    ua "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("' '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Mozilla/5.0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("choice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("os_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'AppleWebKit/537.36'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(KHTML, like Gecko)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" chrome_version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Safari/537.36'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ua \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h5",{attrs:{id:"_2-2-通过referer字段或者是其他字段来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-通过referer字段或者是其他字段来反爬"}},[s._v("#")]),s._v(" 2.2 通过referer字段或者是其他字段来反爬")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：爬虫默认情况下不会带上referer字段")]),s._v(" "),a("li",[s._v("解决方法：添加referer字段（例如豆瓣美剧爬虫，详见课程1.3.2小节）")])]),s._v(" "),a("h5",{attrs:{id:"_2-3-通过cookie来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-通过cookie来反爬"}},[s._v("#")]),s._v(" 2.3 通过cookie来反爬")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("如果目标网站不需要登录 每次请求带上前一次返回的cookie，比如requests模块的session")])]),s._v(" "),a("li",[a("p",[s._v("如果目标网站需要登录 准备多个账号，通过一个程序获取账号对应的cookie，组成cookie池，其他程序使用这些cookie")])])]),s._v(" "),a("h3",{attrs:{id:"_3-通过js来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-通过js来反爬"}},[s._v("#")]),s._v(" 3 通过js来反爬")]),s._v(" "),a("blockquote",[a("p",[s._v("普通的爬虫默认情况下无法执行js，获取js执行之后的结果，所以很多时候对方服务器会通过js的技术实现反爬")])]),s._v(" "),a("h5",{attrs:{id:"_3-1-通过js实现跳转来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-通过js实现跳转来反爬"}},[s._v("#")]),s._v(" 3.1 通过js实现跳转来反爬")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：js实现页面跳转，肉眼不可见")]),s._v(" "),a("li",[s._v("解决方法: 在chrome中点击perserve log按钮实现观察页面跳转情况")])]),s._v(" "),a("p",[s._v("在这些请求中，如果请求数量很多，一般来讲，只有那些response中带cookie字段的请求是有用的，意味着通过这个请求，对方服务器有设置cookie到本地")]),s._v(" "),a("h5",{attrs:{id:"_3-2-通过js生成了请求参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-通过js生成了请求参数"}},[s._v("#")]),s._v(" 3.2 通过js生成了请求参数")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：js生成了请求参数")]),s._v(" "),a("li",[s._v("解决方法：分析js，观察加密的实现过程，通过js2py获取js的执行结果，或者使用selenium来实现")])]),s._v(" "),a("h5",{attrs:{id:"_3-3-通过js实现了数据的加密"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-通过js实现了数据的加密"}},[s._v("#")]),s._v(" 3.3 通过js实现了数据的加密")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：js实现了数据的加密")]),s._v(" "),a("li",[s._v("解决方法：分析js，观察加密的实现过程，通过js2py获取js的执行结果，或者使用selenium来实现")])]),s._v(" "),a("h3",{attrs:{id:"_4-通过验证码来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-通过验证码来反爬"}},[s._v("#")]),s._v(" 4 通过验证码来反爬")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：对方服务器通过弹出验证码强制验证用户浏览行为")]),s._v(" "),a("li",[s._v("解决方法：打码平台或者是机器学习的方法识别验证码，其中打码平台廉价易用，更值得推荐")])]),s._v(" "),a("h3",{attrs:{id:"_5-通过ip地址来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-通过ip地址来反爬"}},[s._v("#")]),s._v(" 5 通过ip地址来反爬")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：正常浏览器请求网站，速度不会太快，同一个ip大量请求了对方服务器，有更大的可能性会被识别为爬虫")]),s._v(" "),a("li",[s._v("解决方法：对应的通过购买高质量的ip的方式能够解决问题")])]),s._v(" "),a("h3",{attrs:{id:"_6-通过用户行为来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-通过用户行为来反爬"}},[s._v("#")]),s._v(" 6 通过用户行为来反爬")]),s._v(" "),a("ul",[a("li",[s._v("反爬原理：通过浏览器请求数据，很多用户行为会在浏览器中是很容易实现或者无法实现.比如浏览器请求额外的图片地址，服务端进行记录，出现意味着不是爬虫(爬虫中不会主动请求图片)")]),s._v(" "),a("li",[s._v("解决方法：通过获取数据的情况来观察请求，寻找异常出现的可能请求")])]),s._v(" "),a("h3",{attrs:{id:"_7-其他的反爬方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-其他的反爬方式"}},[s._v("#")]),s._v(" 7 其他的反爬方式")]),s._v(" "),a("h5",{attrs:{id:"_7-1-通过自定义字体来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-通过自定义字体来反爬"}},[s._v("#")]),s._v(" 7.1 通过自定义字体来反爬")]),s._v(" "),a("p",[s._v("下图来自猫眼电影电脑版")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E4%BD%BF%E7%94%A8%E5%AD%97%E4%BD%93%E6%9D%A5%E5%8F%8D%E7%88%AC.png",alt:""}})]),s._v(" "),a("p",[s._v("解决思路：切换到手机版")]),s._v(" "),a("h5",{attrs:{id:"_7-2-通过css来反爬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-通过css来反爬"}},[s._v("#")]),s._v(" 7.2 通过css来反爬")]),s._v(" "),a("p",[s._v("下图来自猫眼去哪儿电脑版")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/%E9%80%9A%E8%BF%87css%E5%8F%8D%E7%88%AC.png",alt:""}})]),s._v(" "),a("p",[s._v("解决思路：计算css的偏移")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("ul",[a("li",[s._v("反爬的手段非常多，但是一般而言，完全的模仿浏览器的行为即可")])])])}),[],!1,null,null,null);t.default=r.exports}}]);